(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{21:function(e,n,t){e.exports=t(46)},45:function(e,n,t){},46:function(e,n,t){"use strict";t.r(n);var a=t(4),o=t.n(a),i=t(18),r=t.n(i);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var s=t(1),l=t(2),c=t(6),d=t(5),u=t(7),h=t(0),g=function(e){function n(){var e,t;Object(s.a)(this,n);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(t=Object(c.a)(this,(e=Object(d.a)(n)).call.apply(e,[this].concat(o)))).scene=void 0,t.engine=void 0,t.canvas=void 0,t.sceneMountReturn=void 0,t.onResizeWindow=function(){t.engine&&(t.engine.resize(),t.resize())},t.onCanvasLoaded=function(e){null!==e&&(t.canvas=e,t.resize())},t.resize=function(){if(t.canvas.width=t.canvas.parentElement.offsetWidth,t.canvas.height=t.canvas.parentElement.offsetHeight,t.sceneMountReturn&&t.sceneMountReturn.resizeEvents)for(var e=0;e<t.sceneMountReturn.resizeEvents.length;e++)t.sceneMountReturn.resizeEvents[e]()},t}return Object(u.a)(n,e),Object(l.a)(n,[{key:"componentDidMount",value:function(){this.engine=new h.Engine(this.canvas,!0,this.props.engineOptions,this.props.adaptToDeviceRatio),this.scene=new h.Scene(this.engine,this.props.sceneOptions),"function"===typeof this.props.onSceneMount?this.sceneMountReturn=this.props.onSceneMount({scene:this.scene,engine:this.engine,canvas:this.canvas}):console.error("onSceneMount function not available"),window.addEventListener("resize",this.onResizeWindow),window._active_scene=this.scene,window._active_engine=this.engine,window.addEventListener("beforeunload",this.onBeforeUnload)}},{key:"onBeforeUnload",value:function(e){window.removeEventListener("resize",this.onResizeWindow);var n=window._active_scene,t=window._active_engine;n&&n instanceof h.Scene&&n.dispose(),t&&t instanceof h.Engine&&t.dispose(),window.removeEventListener("beforeunload",this.onBeforeUnload)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.onResizeWindow),this.scene.dispose(),this.engine.dispose(),window.removeEventListener("beforeunload",this.onBeforeUnload)}},{key:"render",value:function(){return a.createElement("canvas",{ref:this.onCanvasLoaded,width:"100%",height:"100%"})}}]),n}(a.Component),f=(t(26),function(){function e(){Object(s.a)(this,e)}return Object(l.a)(e,null,[{key:"generateRandomString",value:function(e){for(var n="0123456789QWERTZUIOPLKJHGFDSAYXCVBNMqwertzuioplkjhgfdsayxcvbnm",t="",a=0;a<e;a++){t+=n[Math.floor(Math.random()*n.length)]}return t}},{key:"findFirstChild",value:function(e,n,t){var a=n.getChildTransformNodes(t),o=e.indexOf(":");if(o>0)for(var i=e.substring(0,o),r=e.substring(o+1),s=0;s<a.length;s++){var l=a[s];if(l.name===i)return this.findFirstChild(r,l,t)}else for(var c=0;c<a.length;c++){var d=a[c];if(d.name===e)return d}return null}},{key:"getBounds",value:function(e){var n={x:{min:0,max:0},y:{min:0,max:0},z:{min:0,max:0},width:0,height:0,depth:0},t=!1;if(e instanceof h.AbstractMesh){var a=e.getBoundingInfo().minimum,o=e.getBoundingInfo().maximum;n.x.min=a.x,n.y.min=a.y,n.z.min=a.z,n.x.max=o.x,n.y.max=o.y,n.z.max=o.z,t=!0}for(var i=e.getChildMeshes(),r=0;r<i.length;r++){var s=i[r];if(s.isEnabled()){var l=s.getBoundingInfo().minimum,c=s.getBoundingInfo().maximum;r<1&&!t?(n.x.min=l.x,n.y.min=l.y,n.z.min=l.z,n.x.max=c.x,n.y.max=c.y,n.z.max=c.z):(n.x.min>l.x&&(n.x.min=l.x),n.y.min>l.y&&(n.y.min=l.y),n.z.min>l.z&&(n.z.min=l.z),n.x.max<c.x&&(n.x.max=c.x),n.y.max<c.y&&(n.y.max=c.y),n.z.max<c.z&&(n.z.max=c.z))}}return n.width=Math.abs(n.x.max-n.x.min),n.height=Math.abs(n.y.max-n.y.min),n.depth=Math.abs(n.z.max-n.z.min),n}},{key:"copy",value:function(e,n,t){var a=null;e instanceof h.Mesh?(a=e.createInstance(n),a.parent=t):(a=e.clone(null,t,!0),a.name=n);for(var o=e.getChildTransformNodes(!0),i=0;i<o.length;i++){var r=o[i];this.copy(r,r.name,a)}return a}},{key:"clone",value:function(e,n,t){var a=e.clone(e.name,t||e.parent,!0);a.name=n||e.name,a.id=e.id;for(var o=e.getChildTransformNodes(!0),i=0;i<o.length;i++){var r=o[i];this.clone(r,void 0,a)}return a}},{key:"color",value:function(e,n,t){return new h.Color3(e/255,n/255,t/255)}},{key:"isPointInPoly",value:function(e,n){if(e.length<3)return!1;var t=0,a=0,o=e.length,i=!1;for(t=0,a=o-1;t<o;a=t++)e[t].y>n.y!=e[a].y>n.y&&n.x<(e[a].x-e[t].x)*(n.y-e[t].y)/(e[a].y-e[t].y)+e[t].x&&(i=!i);return i}}]),e}()),m=function(){function e(){Object(s.a)(this,e)}return Object(l.a)(e,null,[{key:"initialize",value:function(){var e=N.CURRENT_SCENE,n=new h.Texture("/texture/wood.jpg",N.CURRENT_SCENE);n.wAng=Math.PI/180*90,n.uScale=.5;var t=new h.Texture("texture/metal.jpg",N.CURRENT_SCENE);t.level=2;var a=new h.Texture("texture/laptop.png",N.CURRENT_SCENE),o=new h.Texture("texture/carpet.jpg",N.CURRENT_SCENE);o.uScale=7.5,o.vScale=7.5;var i=new h.PBRMaterial("_metal",e);i.albedoColor=f.color(155,155,160),i.metallic=.9,i.roughness=.1,i.backFaceCulling=!1,i.clearCoat.isEnabled=!0,i.clearCoat.intensity=.2,i.clearCoat.roughness=.1,i.clearCoat.indexOfRefraction=3,i.specularIntensity=.15,i.directIntensity=1,i.enableSpecularAntiAliasing=!0,i.albedoTexture=t;var r=new h.PBRMaterial("_wood",e);r.albedoColor=f.color(255,255,255),r.metallic=.2,r.roughness=.5,r.backFaceCulling=!1,r.specularIntensity=.15,r.directIntensity=1,r.enableSpecularAntiAliasing=!0,r.albedoTexture=n;var s=new h.PBRMaterial("_laptop",e);s.albedoColor=f.color(255,255,255),s.metallic=.2,s.roughness=.5,s.backFaceCulling=!1,s.specularIntensity=.15,s.directIntensity=1,s.enableSpecularAntiAliasing=!0,s.albedoTexture=a;var l=new h.PBRMaterial("_carpet",e);l.albedoColor=f.color(150,150,150),l.metallic=0,l.roughness=.9,l.backFaceCulling=!1,l.specularIntensity=.15,l.directIntensity=1,l.enableSpecularAntiAliasing=!0,l.albedoTexture=o}}]),e}(),p=(t(27),t(19)),v=t.n(p),E=function(){function e(){Object(s.a)(this,e)}return Object(l.a)(e,null,[{key:"initialize",value:function(){e.loadedNode&&!e.loadedNode.isDisposed()&&e.loadedNode.dispose(),e.loadedNode=new h.TransformNode("_loader",N.CURRENT_SCENE),e.loadedNode.setEnabled(!1),e.loading.clear(),e.loaded.clear()}},{key:"load",value:function(n,t,a){if(e.loaded.has(n)){var o=e.loaded.get(n),i={bounds:f.getBounds(o),model:f.clone(o)};t&&t(i)}else if(e.loading.has(n))e.loading.get(n).push({callback:t,error:a});else{e.loading.set(n,[]);var r=e.defaultSettings.scaling,s=e.defaultSettings.rotation,l=e.defaultSettings.pluginExtension,c=new h.TransformNode(n,N.CURRENT_SCENE);console.log("load",n),v.a.get(n,{withCredentials:!0,headers:{jwt:window.localStorage.getItem("jwt")}}).then(function(a){var o=JSON.stringify(a.data),i=new Map;h.SceneLoader.ImportMesh("","","data:"+o,N.CURRENT_SCENE,function(a,o,l,d){for(var u=0;u<a.length;u++){var g=a[u];if(u<1&&(g.parent=c,g.position=h.Vector3.Zero(),g.scaling=r,g.rotation=s),g.cullingStrategy=h.Mesh.CULLINGSTRATEGY_BOUNDINGSPHERE_ONLY,g.material){g.material.backFaceCulling=!1;for(var m=0;m<N.CURRENT_SCENE.materials.length;m++){var p=N.CURRENT_SCENE.materials[m];if(p.name==="_"+g.material.name&&p.uniqueId!==g.material.uniqueId){i.set(g.material.uniqueId,g.material),g.material=p;break}}}}i.forEach(function(e,n){e.dispose()});for(var v=c.getChildTransformNodes(),E=0;E<v.length;E++){v[E].rotation=h.Vector3.Zero()}c.parent=e.loadedNode,e.loaded.set(n,c);var w={bounds:f.getBounds(c),model:f.clone(c)};console.log("Loaded "+n,w),t&&setTimeout(function(){t(w)});for(var C=e.loading.get(n),y=function(e){var n=C[e],t={bounds:w.bounds,model:f.clone(c)};n.callback&&setTimeout(function(){n.callback(t)})},x=0;x<C.length;x++)y(x);e.loading.delete(n)},void 0,void 0,l)}).catch(function(t){console.log("Unable to load "+n,t),a&&setTimeout(function(){a()});for(var o=e.loading.get(n),i=function(e){var n=o[e];n.error&&setTimeout(function(){n.error()})},r=0;r<o.length;r++)i(r);e.loading.delete(n),c.dispose()})}}},{key:"isLoading",value:function(){return e.loading.size>0}}]),e}();E.defaultSettings={scaling:new h.Vector3(1,1,1),rotation:new h.Vector3(0,0,0),pluginExtension:".gltf"},E.loading=new Map,E.loaded=new Map,E.loadedNode=null;t(45);var w=t(20),C=function(){function e(){Object(s.a)(this,e)}return Object(l.a)(e,null,[{key:"push",value:function(n,t){e.map.has(n)?e.map.set(n,t):(e.map.set(n,t),e.queue.push(n)),e.call()}},{key:"call",value:function(){var n=e.queue.shift(),t=e.map.get(n);if(e.map.delete(n),!e.isRunning&&t){e.isRunning=!0;try{t()}catch(a){console.error(a)}setTimeout(e.call,100),e.isRunning=!1}}}]),e}();C.map=new Map,C.queue=new Array,C.isRunning=!1;var y=function(e){function n(){var e;return Object(s.a)(this,n),(e=Object(c.a)(this,Object(d.a)(n).call(this,"WorkbenchNode",N.CURRENT_SCENE))).bake(),e}return Object(u.a)(n,e),Object(l.a)(n,[{key:"bake",value:function(){var e=this;C.push(this.uniqueId,function(){var n=h.MeshBuilder.CreateGround("ground",{width:1e3,height:1e3},N.CURRENT_SCENE);n.position.y=-78,n.material=N.CURRENT_SCENE.getMaterialByName("_carpet");for(var t,a=new h.Vector3(173,4,84),o=new h.Vector3(3,71,3),i=new h.Vector3(160,o.x,70),r=N.CURRENT_SCENE.getMaterialByName("_metal"),s=N.CURRENT_SCENE.getMaterialByName("_wood"),l=[],c=[],d=0;d<6;d++)c[d]=new h.Vector4(.9,0,1,1);var u={faceUV:c,size:1,wrap:!0},g=h.Mesh.CreateBox("plate",1,N.CURRENT_SCENE);g.scaling=a,g.position=new h.Vector3(g.scaling.x/2,0,-g.scaling.z/2),g.material=s,l.push(g),o.y=o.y-o.x;var f=h.MeshBuilder.CreateBox("leg0",u,N.CURRENT_SCENE);f.scaling=o,f.position=new h.Vector3(o.x/2+(a.x-i.x)/2,-o.y/2-a.y/2-o.x,-o.z/2-(a.z-i.z)/2),f.material=r,l.push(f);var m=h.MeshBuilder.CreateBox("leg1",u,N.CURRENT_SCENE);m.scaling=o,m.position=new h.Vector3(o.x/2+a.x-o.x-(a.x-i.x)/2,-o.y/2-a.y/2-o.x,-o.z/2-(a.z-i.z)/2),m.material=r,l.push(m);var p=h.MeshBuilder.CreateBox("leg2",u,N.CURRENT_SCENE);p.scaling=o,p.position=new h.Vector3(o.x/2+(a.x-i.x)/2,-o.y/2-a.y/2-o.x,-o.z/2-a.z+o.z+(a.z-i.z)/2),p.material=r,l.push(p);var v=h.MeshBuilder.CreateBox("leg3",u,N.CURRENT_SCENE);v.scaling=o,v.position=new h.Vector3(o.x/2+a.x-o.x-(a.x-i.x)/2,-o.y/2-a.y/2-o.x,-o.z/2-a.z+o.z+(a.z-i.z)/2),v.material=r,l.push(v);for(var E=0;E<6;E++)c[E]=new h.Vector4(0,.9,1,1);u.faceUV=c;var w=h.MeshBuilder.CreateBox("frameOut",u,N.CURRENT_SCENE);w.scaling=i;var C=h.MeshBuilder.CreateBox("hole",u,N.CURRENT_SCENE);C.scaling=new h.Vector3(i.x-2*i.y,i.y,i.z-2*i.y);var y=h.CSG.FromMesh(w),x=h.CSG.FromMesh(C);C.dispose(),w.dispose();var R,b=y.subtract(x).toMesh("frame",r,N.CURRENT_SCENE);b.position=new h.Vector3(a.x/2,-(a.y+i.y)/2,-a.z/2),l.push(b),(t=h.Mesh.MergeMeshes(l,!0,void 0,void 0,void 0,!0)).name="table",t.parent=e,h.SceneLoader.ImportMesh("","/gltf/chair/","scene.gltf",N.CURRENT_SCENE,function(n){(R=n[0].getChildTransformNodes()[0].getChildTransformNodes()[0].getChildTransformNodes()[0].getChildTransformNodes()[0]).parent=e,n[0].dispose(),R.name="chair",R.position=new h.Vector3(a.x/2,-o.y,-o.y),R.rotationQuaternion=void 0,R.rotation.y=Math.PI/180*90});for(var S,M=new h.Vector3(37,1,25),z=N.CURRENT_SCENE.getMaterialByName("_laptop"),T=[],_={faceUV:T,size:1,wrap:!0},B=0;B<6;B++)T[B]=new h.Vector4(.5,0,.5,1);T[4]=new h.Vector4(0,.6,.5,1),_.faceUV=T;var U=h.MeshBuilder.CreateBox("lapBase",_,N.CURRENT_SCENE);T[4]=new h.Vector4(.5,0,.5,1),T[1]=new h.Vector4(.5,.6,1,1),_.faceUV=T;var V=h.MeshBuilder.CreateBox("lapScreen",_,N.CURRENT_SCENE);U.scaling=M,V.scaling=new h.Vector3(M.x,M.z,M.y),V.position=new h.Vector3(0,M.z/2-1,M.z/2-Math.sin(22.5)*(M.z/2)-1),V.rotation.x=Math.PI/180*22.5,U.material=z,V.material=z,(S=h.Mesh.MergeMeshes([U,V],!0)).name="laptop",S.parent=e,S.position=new h.Vector3(a.x/2,a.y/2+M.y/2,-a.z/2);var k;return h.SceneLoader.ImportMesh("","/gltf/","DamagedHelmet.gltf",N.CURRENT_SCENE,function(n){(k=n[0].getChildTransformNodes()[0]).parent=e,n[0].dispose(),k.scaling=new h.Vector3(15,15,15),k.position=new h.Vector3(a.x-30,15,-a.z/2),k.rotationQuaternion=void 0,k.rotation=new h.Vector3(Math.PI/180*90,Math.PI/180*215,0)}),h.SceneLoader.ImportMesh("","/gltf/desk_lamp/","scene.gltf",N.CURRENT_SCENE,function(o){var i=o[0].getChildTransformNodes()[0].getChildTransformNodes()[0].getChildTransformNodes()[0].getChildTransformNodes()[0];i.parent=e,o[0].dispose(),i.name="lamp",i.position=new h.Vector3(a.x/4,a.y/2,-a.z/3);var r=new h.PointLight("lamp",new h.Vector3(52,28,-28),N.CURRENT_SCENE);r.intensity=5e3,r.range=1e4,r.parent=e;var s=new h.ShadowGenerator(1024,r);s.getShadowMap().renderList.push(t,S),e.getChildMeshes().forEach(function(e){s.getShadowMap().renderList.push(e)}),e.getChildTransformNodes().forEach(function(e){e.getChildMeshes().forEach(function(e){console.log(e.name)}),e.getChildTransformNodes().forEach(function(e){e.getChildMeshes().forEach(function(e){s.getShadowMap().renderList.push(e),console.log(e.name)}),e.getChildTransformNodes().forEach(function(e){e.getChildMeshes().forEach(function(e){s.getShadowMap().renderList.push(e),console.log(e.name)})})})}),n.receiveShadows=!0,s.usePoissonSampling=!0}),!0})}},{key:"dispose",value:function(){Object(w.a)(Object(d.a)(n.prototype),"dispose",this).call(this)}}]),n}(h.TransformNode),N=function(e){function n(){var e,t;Object(s.a)(this,n);for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return(t=Object(c.a)(this,(e=Object(d.a)(n)).call.apply(e,[this].concat(i))))._scene=void 0,t._initialized=!1,t._babylonScene=a.createRef(),t.onSceneMount=function(e){var a={resizeEvents:new Array},o=e.canvas,i=e.scene,r=e.engine;t._scene=i,n.CURRENT_SCENE=i;i.clearColor=new h.Color4(.4,.4,.4,1),i.ambientColor=new h.Color3(.1,.1,.1),i.fogMode=h.Scene.FOGMODE_LINEAR,i.fogColor=new h.Color3(.4,.4,.4),i.fogStart=1800,i.fogEnd=2800,i.shadowsEnabled=!0;var s=new h.ArcRotateCamera("Camera",0,0,-10,new h.Vector3(86.5,0,-50),i);s.setPosition(new h.Vector3(0,150,-500)),s.lowerBetaLimit=.01,s.lowerRadiusLimit=50,s.upperBetaLimit=Math.PI/2*.9,s.cameraRotation=new h.Vector2(Math.PI,0),s.layerMask=805306367,i.activeCamera=s;var l=new h.DirectionalLight("directional",new h.Vector3(-1,-1,1),i);l.intensity=1,l.position=new h.Vector3(1e3,200,-1400),l.setEnabled(!1);var c=new h.DirectionalLight("directional-shadow",new h.Vector3(-1,-1.5,1),i);c.intensity=.5,c.position=new h.Vector3(1e3,200,-1400),c.lightmapMode=h.Light.LIGHTMAP_SHADOWSONLY,c.setEnabled(!1);var d=new h.DirectionalLight("directional-back",new h.Vector3(1,-1,-1),i);d.intensity=.66,d.position=new h.Vector3(-1e3,200,1400),d.setEnabled(!1);var u=new h.ShadowGenerator(1024,c,!0);u.useBlurExponentialShadowMap=!0,u.blurScale=1,u.usePoissonSampling=!0;new h.SSAORenderingPipeline("ssaopipeline",i,1,[s]);m.initialize(),E.initialize(),t._initialized=!0;return function n(){try{i.render()}catch(e){setTimeout(function(){n()},100)}}(),r.runRenderLoop(function(){try{i&&document.hasFocus()&&i.render()}catch(e){console.error(e)}}),new y,s.attachControl(o,!1),i.onDispose=function(){},o.addEventListener("keyup",function(e){switch(e.key){case"y":for(var n=0;n<i.meshes.length;n++){var t=i.meshes[n];t.id.endsWith("_merged")&&t.enableEdgesRendering(.333)}break;case"+":i.debugLayer.show()}}),a},t}return Object(u.a)(n,e),Object(l.a)(n,[{key:"render",value:function(){return a.createElement("div",{className:"Scene"},a.createElement(g,{onSceneMount:this.onSceneMount,engineOptions:{preserveDrawingBuffer:!0,stencil:!0},sceneOptions:{useClonedMeshMap:!0},ref:this._babylonScene}))}}]),n}(a.Component);N.CURRENT_SCENE=void 0,r.a.render(o.a.createElement(N,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[21,1,2]]]);
//# sourceMappingURL=main.20da7839.chunk.js.map